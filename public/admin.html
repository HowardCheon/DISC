<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DISC 검사 관리자</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>DISC 검사 관리자</h1>
            <div class="admin-nav">
                <button class="nav-btn active" onclick="showSection('dashboard')">대시보드</button>
                <button class="nav-btn" onclick="showSection('testLinks')">검사 링크</button>
                <button class="nav-btn" onclick="showSection('results')">검사 결과</button>
                <button class="nav-btn" onclick="showSection('stats')">통계</button>
                <button class="nav-btn" onclick="showSection('settings')">설정</button>
                <button class="nav-btn logout" onclick="logout()">로그아웃</button>
            </div>
        </header>

        <main>
            <!-- 대시보드 섹션 -->
            <div id="dashboard" class="admin-section active">
                <h2>대시보드</h2>
                <div class="dashboard-cards">
                    <div class="card">
                        <h3>총 테스트 수</h3>
                        <div class="stat-number" id="totalTests">0</div>
                    </div>
                    <div class="card">
                        <h3>오늘 테스트</h3>
                        <div class="stat-number" id="todayTests">0</div>
                    </div>
                    <div class="card">
                        <h3>이번 주 테스트</h3>
                        <div class="stat-number" id="weekTests">0</div>
                    </div>
                    <div class="card">
                        <h3>평균 점수</h3>
                        <div class="stat-number" id="avgScore">0</div>
                    </div>
                </div>

                <div class="recent-tests">
                    <h3>최근 테스트 결과</h3>
                    <div id="recentTestsList"></div>
                </div>
            </div>

            <!-- 검사 링크 섹션 -->
            <div id="testLinks" class="admin-section">
                <h2>검사 링크 생성</h2>

                <div class="link-generator">
                    <div class="generator-form">
                        <h3>새 검사 링크 생성</h3>
                        <div class="form-group">
                            <label for="testTitle">검사 제목 (선택사항)</label>
                            <input type="text" id="testTitle" placeholder="예: 2024년 직원 DISC 검사">
                        </div>

                        <div class="form-group">
                            <label for="testDescription">검사 설명 (선택사항)</label>
                            <textarea id="testDescription" rows="3" placeholder="검사자에게 표시될 설명을 입력하세요..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="linkExpiry">링크 만료 설정</label>
                            <select id="linkExpiry">
                                <option value="never">만료 없음</option>
                                <option value="1">1일 후</option>
                                <option value="7" selected>7일 후</option>
                                <option value="30">30일 후</option>
                                <option value="90">90일 후</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="maxUses">최대 사용 횟수</label>
                            <select id="maxUses">
                                <option value="unlimited">제한 없음</option>
                                <option value="1">1회</option>
                                <option value="5">5회</option>
                                <option value="10">10회</option>
                                <option value="50" selected>50회</option>
                                <option value="100">100회</option>
                            </select>
                        </div>

                        <button class="btn btn-primary" onclick="generateTestLink()">검사 링크 생성</button>
                    </div>

                    <div class="generated-link" id="generatedLink" style="display: none;">
                        <h3>생성된 검사 링크</h3>
                        <div class="link-display">
                            <div class="link-url" id="linkUrl"></div>
                            <button class="btn btn-secondary" onclick="copyLink()">링크 복사</button>
                        </div>
                        <div class="link-info" id="linkInfo"></div>
                        <div class="link-actions">
                            <button class="btn btn-success" onclick="sendLinkByEmail()">이메일 전송</button>
                            <button class="btn btn-info" onclick="generateQRCode()">QR 코드 생성</button>
                            <button class="btn btn-warning" onclick="previewTestPage()">미리보기</button>
                        </div>
                    </div>
                </div>

                <div class="active-links">
                    <h3>활성 검사 링크 목록</h3>
                    <div id="activeLinksList">
                        <!-- 동적으로 생성 -->
                    </div>
                </div>
            </div>

            <!-- 검사 결과 섹션 -->
            <div id="results" class="admin-section">
                <h2>검사 결과 관리</h2>
                <div class="search-controls">
                    <input type="text" id="searchInput" placeholder="이름으로 검색...">
                    <input type="date" id="dateFilter">
                    <button onclick="searchResults()">검색</button>
                    <button onclick="exportResults()">내보내기</button>
                </div>
                <div id="resultsTable"></div>
            </div>

            <!-- 통계 섹션 -->
            <div id="stats" class="admin-section">
                <h2>통계 분석</h2>
                <div class="stats-charts">
                    <div class="chart-container">
                        <h3>DISC 유형별 분포</h3>
                        <canvas id="typeDistributionChart" width="400" height="300"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>월별 테스트 현황</h3>
                        <canvas id="monthlyChart" width="400" height="300"></canvas>
                    </div>
                </div>
            </div>

            <!-- 설정 섹션 -->
            <div id="settings" class="admin-section">
                <h2>시스템 설정</h2>
                <div class="settings-form">
                    <div class="setting-group">
                        <h3>데이터 관리</h3>
                        <button onclick="clearOldData()" class="btn btn-warning">30일 이전 데이터 정리</button>
                        <button onclick="clearAllData()" class="btn btn-danger">모든 데이터 삭제</button>
                    </div>
                    <div class="setting-group">
                        <h3>백업/복원</h3>
                        <button onclick="backupData()" class="btn btn-primary">데이터 백업</button>
                        <input type="file" id="restoreFile" accept=".json" style="display: none;">
                        <button onclick="document.getElementById('restoreFile').click()" class="btn btn-secondary">데이터 복원</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 상세 결과 모달 -->
    <div id="resultModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">검사 결과</h2>
                <span class="close" onclick="closeResultModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="result-container">
                    <div class="result-summary">
                        <h3>주요 성격 유형</h3>
                        <div class="main-type" id="modalMainType">
                            <!-- 동적으로 생성 -->
                        </div>
                    </div>

                    <div class="result-charts">
                        <h4>상세 결과 그래프</h4>
                        <div class="charts-container">
                            <div class="chart-section">
                                <h5>그래프 I</h5>
                                <canvas id="modalChart1" width="300" height="400"></canvas>
                            </div>
                            <div class="chart-section">
                                <h5>그래프 II</h5>
                                <canvas id="modalChart2" width="300" height="400"></canvas>
                            </div>
                            <div class="chart-section">
                                <h5>그래프 III</h5>
                                <canvas id="modalChart3" width="300" height="400"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="result-description">
                        <div class="type-descriptions" id="modalTypeDescriptions">
                            <!-- 동적으로 생성 -->
                        </div>
                    </div>

                    <div class="actions">
                        <button class="btn btn-primary" onclick="printModalResult()">결과 인쇄</button>
                        <button class="btn btn-secondary" onclick="closeResultModal()">닫기</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/admin.js"></script>
</body>
</html>